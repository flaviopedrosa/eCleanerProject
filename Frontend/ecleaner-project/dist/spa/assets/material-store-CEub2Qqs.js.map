{"version":3,"file":"material-store-CEub2Qqs.js","sources":["../../../src/stores/material-store.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { Material } from '@/core/domain/entities/material'\nimport { MaterialRepository } from '@/core/infrastructure/repositories/materialRepository'\n\nexport const useMaterialStore = defineStore('material', {\n  state: () => ({\n    Materiais: [],\n    Loading: false,\n    Error: null,\n  }),\n\n  actions: {\n    // Inicializa o repository\n    _getRepository() {\n      return new MaterialRepository()\n    },\n\n    // Carrega todos os materiais\n    async loadMateriais() {\n      this.Loading = true\n      this.Error = null\n      try {\n        const repository = this._getRepository()\n        this.Materiais = await repository.getAll()\n      } catch (error) {\n        this.Error = error.message\n        throw error\n      } finally {\n        this.Loading = false\n      }\n    },\n\n    // Adiciona um novo material\n    async addMaterial(materialData) {\n      this.Loading = true\n      this.Error = null\n      try {\n        const material = new Material(\n          materialData.Descricao,\n          materialData.Unidade,\n          parseFloat(materialData.PrecoUnitario) || 0, // Garante que seja um número válido\n          materialData.Imagem,\n          materialData.Url,\n        )\n\n        const repository = this._getRepository()\n        const novoMaterial = await repository.create(material)\n        this.Materiais.push(novoMaterial)\n        return novoMaterial\n      } catch (error) {\n        this.Error = error.message\n        throw error\n      } finally {\n        this.Loading = false\n      }\n    },\n\n    // Atualiza um material existente\n    async updateMaterial(materialData) {\n      this.Loading = true\n      this.Error = null\n      try {\n        // Garante que o preço seja um número válido\n        const dadosCorrigidos = {\n          ...materialData,\n          PrecoUnitario: parseFloat(materialData.PrecoUnitario) || 0,\n        }\n\n        const repository = this._getRepository()\n        const materialAtualizado = await repository.update(dadosCorrigidos)\n\n        const index = this.Materiais.findIndex((m) => m.Id === materialData.Id)\n        if (index !== -1) {\n          this.Materiais[index] = materialAtualizado\n        }\n        return materialAtualizado\n      } catch (error) {\n        this.Error = error.message\n        throw error\n      } finally {\n        this.Loading = false\n      }\n    },\n\n    // Remove um material\n    async deleteMaterial(id) {\n      this.Loading = true\n      this.Error = null\n      try {\n        const repository = this._getRepository()\n        await repository.delete(id)\n        this.Materiais = this.Materiais.filter((m) => m.Id !== id)\n      } catch (error) {\n        this.Error = error.message\n        throw error\n      } finally {\n        this.Loading = false\n      }\n    },\n\n    // Busca um material por ID\n    async getMaterialById(id) {\n      try {\n        const repository = this._getRepository()\n        return await repository.getById(id)\n      } catch (error) {\n        this.Error = error.message\n        throw error\n      }\n    },\n\n    // Busca materiais por descrição\n    async searchMateriais(termo) {\n      this.Loading = true\n      this.Error = null\n      try {\n        const repository = this._getRepository()\n        return await repository.searchByDescricao(termo)\n      } catch (error) {\n        this.Error = error.message\n        throw error\n      } finally {\n        this.Loading = false\n      }\n    },\n\n    // Limpa o estado de erro\n    clearError() {\n      this.Error = null\n    },\n  },\n\n  getters: {\n    // Total de materiais\n    TotalMateriais: (state) => state.Materiais.length,\n\n    // Materiais ordenados por descrição\n    MateriaisOrdenados: (state) => {\n      return [...state.Materiais].sort((a, b) =>\n        a.Descricao.localeCompare(b.Descricao, 'pt-BR', { sensitivity: 'base' }),\n      )\n    },\n\n    // Verifica se há materiais\n    HasMateriais: (state) => state.Materiais.length > 0,\n\n    // Estado de loading\n    IsLoading: (state) => state.Loading,\n\n    // Estado de erro\n    HasError: (state) => !!state.Error,\n  },\n})\n"],"names":[],"mappings":"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"}