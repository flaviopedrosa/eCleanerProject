{"version":3,"file":"servico-store-D0uFN8Hc.js","sources":["../../../src/core/infrastructure/repositories/servicoRepository.js","../../../src/stores/servico-store.js"],"sourcesContent":["import { Servico } from '../../domain/entities/servico.js'\n\n/**\n * Repositório para gerenciar os serviços no localStorage\n */\nexport class ServicoRepository {\n  constructor() {\n    this.storageKey = 'ecleaner_servicos'\n  }\n\n  /**\n   * Salva todos os serviços\n   */\n  salvarTodos(servicos) {\n    const servicosJson = servicos.map((servico) => (servico.toJSON ? servico.toJSON() : servico))\n    localStorage.setItem(this.storageKey, JSON.stringify(servicosJson))\n  }\n\n  /**\n   * Busca todos os serviços\n   */\n  buscarTodos() {\n    const servicosJson = JSON.parse(localStorage.getItem(this.storageKey) || '[]')\n    return servicosJson.map((servicoData) => {\n      // Se já é uma instância de Servico, retorna como está\n      if (servicoData instanceof Servico) return servicoData\n\n      // Se tem a estrutura nova (com propriedades capitalizadas)\n      if (servicoData.Nome) {\n        return new Servico(\n          servicoData.Nome,\n          servicoData.Descricao,\n          servicoData.Valor,\n          servicoData.Unidade,\n          servicoData.Observacao,\n        )\n      }\n\n      // Se tem a estrutura antiga (com propriedades minúsculas) - para compatibilidade\n      return new Servico(\n        servicoData.nome || servicoData.Nome,\n        servicoData.descricao || servicoData.Descricao,\n        servicoData.valor || servicoData.Valor,\n        servicoData.unidade || servicoData.Unidade || 'Unidade',\n        servicoData.observacao || servicoData.Observacao || '',\n      )\n    })\n  }\n\n  /**\n   * Busca serviço por ID\n   */\n  buscarPorId(id) {\n    const servicos = this.buscarTodos()\n    return servicos.find((servico) => servico.Id === id)\n  }\n\n  /**\n   * Adiciona um novo serviço\n   */\n  adicionar(servico) {\n    const servicos = this.buscarTodos()\n    servicos.push(servico)\n    this.salvarTodos(servicos)\n    return servico\n  }\n\n  /**\n   * Atualiza um serviço existente\n   */\n  atualizar(servicoAtualizado) {\n    const servicos = this.buscarTodos()\n    const index = servicos.findIndex((servico) => servico.Id === servicoAtualizado.Id)\n\n    if (index !== -1) {\n      servicoAtualizado.marcarComoAtualizado()\n      servicos[index] = servicoAtualizado\n      this.salvarTodos(servicos)\n      return servicoAtualizado\n    }\n\n    throw new Error('Serviço não encontrado')\n  }\n\n  /**\n   * Remove um serviço\n   */\n  remover(id) {\n    const servicos = this.buscarTodos()\n    const servicosFiltrados = servicos.filter((servico) => servico.Id !== id)\n\n    if (servicosFiltrados.length < servicos.length) {\n      this.salvarTodos(servicosFiltrados)\n      return true\n    }\n\n    return false\n  }\n\n  /**\n   * Limpa todos os serviços\n   */\n  limparTodos() {\n    localStorage.removeItem(this.storageKey)\n  }\n\n  /**\n   * Conta total de serviços\n   */\n  contar() {\n    return this.buscarTodos().length\n  }\n\n  /**\n   * Busca serviços por faixa de preço\n   */\n  buscarPorFaixaPreco(valorMin, valorMax) {\n    const servicos = this.buscarTodos()\n    return servicos.filter((servico) => servico.Valor >= valorMin && servico.Valor <= valorMax)\n  }\n}\n\n// Instância singleton do repositório\nexport const servicoRepository = new ServicoRepository()\n","import { defineStore } from 'pinia'\nimport { servicoRepository } from '@/core/infrastructure/repositories/servicoRepository'\n\nexport const useServicoStore = defineStore('servico', {\n  state: () => ({\n    servicos: [],\n    loading: false,\n    error: null,\n  }),\n  actions: {\n    async fetchServicos() {\n      this.loading = true\n      try {\n        // Busca os serviços do localStorage através do repositório\n        this.servicos = servicoRepository.buscarTodos()\n        this.error = null\n      } catch (e) {\n        this.error = e.message\n        console.error('Erro ao buscar serviços:', e)\n      } finally {\n        this.loading = false\n      }\n    },\n    async addServico(servico) {\n      try {\n        const novoServico = servicoRepository.adicionar(servico)\n        this.servicos.push(novoServico)\n        this.error = null\n      } catch (e) {\n        this.error = e.message\n        console.error('Erro ao adicionar serviço:', e)\n        throw e\n      }\n    },\n    async updateServico(servico) {\n      try {\n        const servicoAtualizado = servicoRepository.atualizar(servico)\n        const idx = this.servicos.findIndex((s) => s.Id === servico.Id)\n        if (idx !== -1) this.servicos[idx] = servicoAtualizado\n        this.error = null\n      } catch (e) {\n        this.error = e.message\n        console.error('Erro ao atualizar serviço:', e)\n        throw e\n      }\n    },\n    async deleteServico(id) {\n      try {\n        const removido = servicoRepository.remover(id)\n        if (removido) {\n          this.servicos = this.servicos.filter((s) => s.Id !== id)\n        }\n        this.error = null\n      } catch (e) {\n        this.error = e.message\n        console.error('Erro ao deletar serviço:', e)\n        throw e\n      }\n    },\n  },\n})\n"],"names":[],"mappings":"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"}