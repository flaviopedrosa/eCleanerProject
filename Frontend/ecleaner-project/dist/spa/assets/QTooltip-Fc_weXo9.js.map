{"version":3,"file":"QTooltip-Fc_weXo9.js","sources":["../../../node_modules/quasar/src/components/tooltip/QTooltip.js"],"sourcesContent":["import { h, ref, computed, watch, onBeforeUnmount, Transition, getCurrentInstance } from 'vue'\n\nimport useAnchor, { useAnchorStaticProps } from '../../composables/private.use-anchor/use-anchor.js'\nimport useScrollTarget from '../../composables/private.use-scroll-target/use-scroll-target.js'\nimport useModelToggle, { useModelToggleProps, useModelToggleEmits } from '../../composables/private.use-model-toggle/use-model-toggle.js'\nimport usePortal from '../../composables/private.use-portal/use-portal.js'\nimport useTransition, { useTransitionProps } from '../../composables/private.use-transition/use-transition.js'\nimport useTick from '../../composables/use-tick/use-tick.js'\nimport useTimeout from '../../composables/use-timeout/use-timeout.js'\n\nimport { createComponent } from '../../utils/private.create/create.js'\nimport { getScrollTarget, scrollTargetProp } from '../../utils/scroll/scroll.js'\nimport { stopAndPrevent, addEvt, cleanEvt } from '../../utils/event/event.js'\nimport { clearSelection } from '../../utils/private.selection/selection.js'\nimport { hSlot } from '../../utils/private.render/render.js'\nimport { addClickOutside, removeClickOutside } from '../../utils/private.click-outside/click-outside.js'\nimport {\n  validatePosition, validateOffset, setPosition, parsePosition\n} from '../../utils/private.position-engine/position-engine.js'\n\nexport default createComponent({\n  name: 'QTooltip',\n\n  inheritAttrs: false,\n\n  props: {\n    ...useAnchorStaticProps,\n    ...useModelToggleProps,\n    ...useTransitionProps,\n\n    maxHeight: {\n      type: String,\n      default: null\n    },\n    maxWidth: {\n      type: String,\n      default: null\n    },\n\n    transitionShow: {\n      ...useTransitionProps.transitionShow,\n      default: 'jump-down'\n    },\n    transitionHide: {\n      ...useTransitionProps.transitionHide,\n      default: 'jump-up'\n    },\n\n    anchor: {\n      type: String,\n      default: 'bottom middle',\n      validator: validatePosition\n    },\n    self: {\n      type: String,\n      default: 'top middle',\n      validator: validatePosition\n    },\n    offset: {\n      type: Array,\n      default: () => [ 14, 14 ],\n      validator: validateOffset\n    },\n\n    scrollTarget: scrollTargetProp,\n\n    delay: {\n      type: Number,\n      default: 0\n    },\n\n    hideDelay: {\n      type: Number,\n      default: 0\n    },\n\n    persistent: Boolean\n  },\n\n  emits: [\n    ...useModelToggleEmits\n  ],\n\n  setup (props, { slots, emit, attrs }) {\n    let unwatchPosition, observer\n\n    const vm = getCurrentInstance()\n    const { proxy: { $q } } = vm\n\n    const innerRef = ref(null)\n    const showing = ref(false)\n\n    const anchorOrigin = computed(() => parsePosition(props.anchor, $q.lang.rtl))\n    const selfOrigin = computed(() => parsePosition(props.self, $q.lang.rtl))\n    const hideOnRouteChange = computed(() => props.persistent !== true)\n\n    const { registerTick, removeTick } = useTick()\n    const { registerTimeout } = useTimeout()\n    const { transitionProps, transitionStyle } = useTransition(props)\n    const { localScrollTarget, changeScrollEvent, unconfigureScrollTarget } = useScrollTarget(props, configureScrollTarget)\n\n    const { anchorEl, canShow, anchorEvents } = useAnchor({ showing, configureAnchorEl })\n\n    const { show, hide } = useModelToggle({\n      showing, canShow, handleShow, handleHide,\n      hideOnRouteChange,\n      processOnMount: true\n    })\n\n    Object.assign(anchorEvents, { delayShow, delayHide })\n\n    const { showPortal, hidePortal, renderPortal } = usePortal(vm, innerRef, renderPortalContent, 'tooltip')\n\n    // if we're on mobile, let's improve the experience\n    // by closing it when user taps outside of it\n    if ($q.platform.is.mobile === true) {\n      const clickOutsideProps = {\n        anchorEl,\n        innerRef,\n        onClickOutside (e) {\n          hide(e)\n\n          // prevent click if it's on a dialog backdrop\n          if (e.target.classList.contains('q-dialog__backdrop')) {\n            stopAndPrevent(e)\n          }\n\n          return true\n        }\n      }\n\n      const hasClickOutside = computed(() =>\n        // it doesn't has external model\n        // (null is the default value)\n        props.modelValue === null\n        // and it's not persistent\n        && props.persistent !== true\n        && showing.value === true\n      )\n\n      watch(hasClickOutside, val => {\n        const fn = val === true ? addClickOutside : removeClickOutside\n        fn(clickOutsideProps)\n      })\n\n      onBeforeUnmount(() => {\n        removeClickOutside(clickOutsideProps)\n      })\n    }\n\n    function handleShow (evt) {\n      showPortal()\n\n      // should removeTick() if this gets removed\n      registerTick(() => {\n        observer = new MutationObserver(() => updatePosition())\n        observer.observe(innerRef.value, { attributes: false, childList: true, characterData: true, subtree: true })\n        updatePosition()\n        configureScrollTarget()\n      })\n\n      if (unwatchPosition === void 0) {\n        unwatchPosition = watch(\n          () => $q.screen.width + '|' + $q.screen.height + '|' + props.self + '|' + props.anchor + '|' + $q.lang.rtl,\n          updatePosition\n        )\n      }\n\n      // should removeTimeout() if this gets removed\n      registerTimeout(() => {\n        showPortal(true) // done showing portal\n        emit('show', evt)\n      }, props.transitionDuration)\n    }\n\n    function handleHide (evt) {\n      removeTick()\n      hidePortal()\n\n      anchorCleanup()\n\n      // should removeTimeout() if this gets removed\n      registerTimeout(() => {\n        hidePortal(true) // done hiding, now destroy\n        emit('hide', evt)\n      }, props.transitionDuration)\n    }\n\n    function anchorCleanup () {\n      if (observer !== void 0) {\n        observer.disconnect()\n        observer = void 0\n      }\n\n      if (unwatchPosition !== void 0) {\n        unwatchPosition()\n        unwatchPosition = void 0\n      }\n\n      unconfigureScrollTarget()\n      cleanEvt(anchorEvents, 'tooltipTemp')\n    }\n\n    function updatePosition () {\n      setPosition({\n        targetEl: innerRef.value,\n        offset: props.offset,\n        anchorEl: anchorEl.value,\n        anchorOrigin: anchorOrigin.value,\n        selfOrigin: selfOrigin.value,\n        maxHeight: props.maxHeight,\n        maxWidth: props.maxWidth\n      })\n    }\n\n    function delayShow (evt) {\n      if ($q.platform.is.mobile === true) {\n        clearSelection()\n        document.body.classList.add('non-selectable')\n\n        const target = anchorEl.value\n        const evts = [ 'touchmove', 'touchcancel', 'touchend', 'click' ]\n          .map(e => ([ target, e, 'delayHide', 'passiveCapture' ]))\n\n        addEvt(anchorEvents, 'tooltipTemp', evts)\n      }\n\n      registerTimeout(() => { show(evt) }, props.delay)\n    }\n\n    function delayHide (evt) {\n      if ($q.platform.is.mobile === true) {\n        cleanEvt(anchorEvents, 'tooltipTemp')\n        clearSelection()\n        // delay needed otherwise selection still occurs\n        setTimeout(() => {\n          document.body.classList.remove('non-selectable')\n        }, 10)\n      }\n\n      // should removeTimeout() if this gets removed\n      registerTimeout(() => { hide(evt) }, props.hideDelay)\n    }\n\n    function configureAnchorEl () {\n      if (\n        props.noParentEvent === true\n        || anchorEl.value === null\n      ) return\n\n      const evts = $q.platform.is.mobile === true\n        ? [\n            [ anchorEl.value, 'touchstart', 'delayShow', 'passive' ]\n          ]\n        : [\n            [ anchorEl.value, 'mouseenter', 'delayShow', 'passive' ],\n            [ anchorEl.value, 'mouseleave', 'delayHide', 'passive' ]\n          ]\n\n      addEvt(anchorEvents, 'anchor', evts)\n    }\n\n    function configureScrollTarget () {\n      if (anchorEl.value !== null || props.scrollTarget !== void 0) {\n        localScrollTarget.value = getScrollTarget(anchorEl.value, props.scrollTarget)\n        const fn = props.noParentEvent === true\n          ? updatePosition\n          : hide\n\n        changeScrollEvent(localScrollTarget.value, fn)\n      }\n    }\n\n    function getTooltipContent () {\n      return showing.value === true\n        ? h('div', {\n          ...attrs,\n          ref: innerRef,\n          class: [\n            'q-tooltip q-tooltip--style q-position-engine no-pointer-events',\n            attrs.class\n          ],\n          style: [\n            attrs.style,\n            transitionStyle.value\n          ],\n          role: 'tooltip'\n        }, hSlot(slots.default))\n        : null\n    }\n\n    function renderPortalContent () {\n      return h(Transition, transitionProps.value, getTooltipContent)\n    }\n\n    onBeforeUnmount(anchorCleanup)\n\n    // expose public methods\n    Object.assign(vm.proxy, { updatePosition })\n\n    return renderPortal\n  }\n})\n"],"names":[],"mappings":";;;;;AAoBA,MAAA,WAAe,gBAAgB;AAAA,EAC7B,MAAM;AAAA,EAEN,cAAc;AAAA,EAEd,OAAO;AAAA,IACL,GAAG;AAAA,IACH,GAAG;AAAA,IACH,GAAG;AAAA,IAEH,WAAW;AAAA,MACT,MAAM;AAAA,MACN,SAAS;AAAA,IACf;AAAA,IACI,UAAU;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,IACf;AAAA,IAEI,gBAAgB;AAAA,MACd,GAAG,mBAAmB;AAAA,MACtB,SAAS;AAAA,IACf;AAAA,IACI,gBAAgB;AAAA,MACd,GAAG,mBAAmB;AAAA,MACtB,SAAS;AAAA,IACf;AAAA,IAEI,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW;AAAA,IACjB;AAAA,IACI,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW;AAAA,IACjB;AAAA,IACI,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,SAAS,MAAM,CAAE,IAAI,EAAE;AAAA,MACvB,WAAW;AAAA,IACjB;AAAA,IAEI,cAAc;AAAA,IAEd,OAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,IACf;AAAA,IAEI,WAAW;AAAA,MACT,MAAM;AAAA,MACN,SAAS;AAAA,IACf;AAAA,IAEI,YAAY;AAAA,EAChB;AAAA,EAEE,OAAO;AAAA,IACL,GAAG;AAAA,EACP;AAAA,EAEE,MAAO,OAAO,EAAE,OAAO,MAAM,MAAK,GAAI;AACpC,QAAI,iBAAiB;AAErB,UAAM,KAAK,mBAAkB;AAC7B,UAAM,EAAE,OAAO,EAAE,GAAE,MAAO;AAE1B,UAAM,WAAW,IAAI,IAAI;AACzB,UAAM,UAAU,IAAI,KAAK;AAEzB,UAAM,eAAe,SAAS,MAAM,cAAc,MAAM,QAAQ,GAAG,KAAK,GAAG,CAAC;AAC5E,UAAM,aAAa,SAAS,MAAM,cAAc,MAAM,MAAM,GAAG,KAAK,GAAG,CAAC;AACxE,UAAM,oBAAoB,SAAS,MAAM,MAAM,eAAe,IAAI;AAElE,UAAM,EAAE,cAAc,WAAU,IAAK,QAAO;AAC5C,UAAM,EAAE,gBAAe,IAAK,WAAU;AACtC,UAAM,EAAE,iBAAiB,gBAAe,IAAK,cAAc,KAAK;AAChE,UAAM,EAAE,mBAAmB,mBAAmB,wBAAuB,IAAK,gBAAgB,OAAO,qBAAqB;AAEtH,UAAM,EAAE,UAAU,SAAS,aAAY,IAAK,UAAU,EAAE,SAAS,kBAAiB,CAAE;AAEpF,UAAM,EAAE,MAAM,KAAI,IAAK,eAAe;AAAA,MACpC;AAAA,MAAS;AAAA,MAAS;AAAA,MAAY;AAAA,MAC9B;AAAA,MACA,gBAAgB;AAAA,IACtB,CAAK;AAED,WAAO,OAAO,cAAc,EAAE,WAAW,UAAS,CAAE;AAEpD,UAAM,EAAE,YAAY,YAAY,aAAY,IAAK,UAAU,IAAI,UAAU,qBAAqB,SAAS;AAIvG,QAAI,GAAG,SAAS,GAAG,WAAW,MAAM;AAClC,YAAM,oBAAoB;AAAA,QACxB;AAAA,QACA;AAAA,QACA,eAAgB,GAAG;AACjB,eAAK,CAAC;AAGN,cAAI,EAAE,OAAO,UAAU,SAAS,oBAAoB,GAAG;AACrD,2BAAe,CAAC;AAAA,UAClB;AAEA,iBAAO;AAAA,QACT;AAAA,MACR;AAEM,YAAM,kBAAkB;AAAA,QAAS;AAAA;AAAA;AAAA,UAG/B,MAAM,eAAe,QAElB,MAAM,eAAe,QACrB,QAAQ,UAAU;AAAA;AAAA,MAC7B;AAEM,YAAM,iBAAiB,SAAO;AAC5B,cAAM,KAAK,QAAQ,OAAO,kBAAkB;AAC5C,WAAG,iBAAiB;AAAA,MACtB,CAAC;AAED,sBAAgB,MAAM;AACpB,2BAAmB,iBAAiB;AAAA,MACtC,CAAC;AAAA,IACH;AAEA,aAAS,WAAY,KAAK;AACxB,iBAAU;AAGV,mBAAa,MAAM;AACjB,mBAAW,IAAI,iBAAiB,MAAM,eAAc,CAAE;AACtD,iBAAS,QAAQ,SAAS,OAAO,EAAE,YAAY,OAAO,WAAW,MAAM,eAAe,MAAM,SAAS,KAAI,CAAE;AAC3G,uBAAc;AACd,8BAAqB;AAAA,MACvB,CAAC;AAED,UAAI,oBAAoB,QAAQ;AAC9B,0BAAkB;AAAA,UAChB,MAAM,GAAG,OAAO,QAAQ,MAAM,GAAG,OAAO,SAAS,MAAM,MAAM,OAAO,MAAM,MAAM,SAAS,MAAM,GAAG,KAAK;AAAA,UACvG;AAAA,QACV;AAAA,MACM;AAGA,sBAAgB,MAAM;AACpB,mBAAW,IAAI;AACf,aAAK,QAAQ,GAAG;AAAA,MAClB,GAAG,MAAM,kBAAkB;AAAA,IAC7B;AAEA,aAAS,WAAY,KAAK;AACxB,iBAAU;AACV,iBAAU;AAEV,oBAAa;AAGb,sBAAgB,MAAM;AACpB,mBAAW,IAAI;AACf,aAAK,QAAQ,GAAG;AAAA,MAClB,GAAG,MAAM,kBAAkB;AAAA,IAC7B;AAEA,aAAS,gBAAiB;AACxB,UAAI,aAAa,QAAQ;AACvB,iBAAS,WAAU;AACnB,mBAAW;AAAA,MACb;AAEA,UAAI,oBAAoB,QAAQ;AAC9B,wBAAe;AACf,0BAAkB;AAAA,MACpB;AAEA,8BAAuB;AACvB,eAAS,cAAc,aAAa;AAAA,IACtC;AAEA,aAAS,iBAAkB;AACzB,kBAAY;AAAA,QACV,UAAU,SAAS;AAAA,QACnB,QAAQ,MAAM;AAAA,QACd,UAAU,SAAS;AAAA,QACnB,cAAc,aAAa;AAAA,QAC3B,YAAY,WAAW;AAAA,QACvB,WAAW,MAAM;AAAA,QACjB,UAAU,MAAM;AAAA,MACxB,CAAO;AAAA,IACH;AAEA,aAAS,UAAW,KAAK;AACvB,UAAI,GAAG,SAAS,GAAG,WAAW,MAAM;AAClC,uBAAc;AACd,iBAAS,KAAK,UAAU,IAAI,gBAAgB;AAE5C,cAAM,SAAS,SAAS;AACxB,cAAM,OAAO,CAAE,aAAa,eAAe,YAAY,OAAO,EAC3D,IAAI,OAAM,CAAE,QAAQ,GAAG,aAAa,iBAAmB;AAE1D,eAAO,cAAc,eAAe,IAAI;AAAA,MAC1C;AAEA,sBAAgB,MAAM;AAAE,aAAK,GAAG;AAAA,MAAE,GAAG,MAAM,KAAK;AAAA,IAClD;AAEA,aAAS,UAAW,KAAK;AACvB,UAAI,GAAG,SAAS,GAAG,WAAW,MAAM;AAClC,iBAAS,cAAc,aAAa;AACpC,uBAAc;AAEd,mBAAW,MAAM;AACf,mBAAS,KAAK,UAAU,OAAO,gBAAgB;AAAA,QACjD,GAAG,EAAE;AAAA,MACP;AAGA,sBAAgB,MAAM;AAAE,aAAK,GAAG;AAAA,MAAE,GAAG,MAAM,SAAS;AAAA,IACtD;AAEA,aAAS,oBAAqB;AAC5B,UACE,MAAM,kBAAkB,QACrB,SAAS,UAAU,KACtB;AAEF,YAAM,OAAO,GAAG,SAAS,GAAG,WAAW,OACnC;AAAA,QACE,CAAE,SAAS,OAAO,cAAc,aAAa,SAAS;AAAA,MAClE,IACU;AAAA,QACE,CAAE,SAAS,OAAO,cAAc,aAAa,SAAS;AAAA,QACtD,CAAE,SAAS,OAAO,cAAc,aAAa,SAAS;AAAA,MAClE;AAEM,aAAO,cAAc,UAAU,IAAI;AAAA,IACrC;AAEA,aAAS,wBAAyB;AAChC,UAAI,SAAS,UAAU,QAAQ,MAAM,iBAAiB,QAAQ;AAC5D,0BAAkB,QAAQ,gBAAgB,SAAS,OAAO,MAAM,YAAY;AAC5E,cAAM,KAAK,MAAM,kBAAkB,OAC/B,iBACA;AAEJ,0BAAkB,kBAAkB,OAAO,EAAE;AAAA,MAC/C;AAAA,IACF;AAEA,aAAS,oBAAqB;AAC5B,aAAO,QAAQ,UAAU,OACrB,EAAE,OAAO;AAAA,QACT,GAAG;AAAA,QACH,KAAK;AAAA,QACL,OAAO;AAAA,UACL;AAAA,UACA,MAAM;AAAA,QAClB;AAAA,QACU,OAAO;AAAA,UACL,MAAM;AAAA,UACN,gBAAgB;AAAA,QAC5B;AAAA,QACU,MAAM;AAAA,MAChB,GAAW,MAAM,MAAM,OAAO,CAAC,IACrB;AAAA,IACN;AAEA,aAAS,sBAAuB;AAC9B,aAAO,EAAE,YAAY,gBAAgB,OAAO,iBAAiB;AAAA,IAC/D;AAEA,oBAAgB,aAAa;AAG7B,WAAO,OAAO,GAAG,OAAO,EAAE,eAAc,CAAE;AAE1C,WAAO;AAAA,EACT;AACF,CAAC;","x_google_ignoreList":[0]}