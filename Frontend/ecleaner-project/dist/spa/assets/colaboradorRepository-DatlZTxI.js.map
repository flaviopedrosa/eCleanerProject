{"version":3,"file":"colaboradorRepository-DatlZTxI.js","sources":["../../../src/core/infrastructure/repositories/colaboradorRepository.js"],"sourcesContent":["import { Colaborador } from '../../domain/entities/colaborador'\nimport { Endereco } from '../../domain/entities/endereco'\nimport { ExperienciaProfissional, Referencia } from '../../domain/entities/documentosColaborador'\n\nexport class ColaboradorRepository {\n  constructor() {\n    // Inicializa o array de colaboradores no localStorage se não existir\n    if (!localStorage.getItem('colaboradores')) {\n      localStorage.setItem('colaboradores', JSON.stringify([]))\n    }\n  }\n\n  // Limpa todos os dados do repositório\n  async clear() {\n    try {\n      localStorage.setItem('colaboradores', JSON.stringify([]))\n    } catch (error) {\n      console.error('Erro ao limpar colaboradores:', error)\n      throw new Error('Erro ao limpar colaboradores')\n    }\n  }\n\n  // Converte um objeto JSON em uma entidade Colaborador\n  _mapToEntity(data) {\n    if (!data) return null\n\n    // Se a fotoPerfil ou currículo é um File ou Blob, cria uma URL para eles\n    let fotoPerfil = data.fotoPerfil\n    if (fotoPerfil instanceof File || fotoPerfil instanceof Blob) {\n      fotoPerfil = URL.createObjectURL(fotoPerfil)\n    }\n\n    let curriculo = data.curriculo\n    if (curriculo instanceof File || curriculo instanceof Blob) {\n      curriculo = URL.createObjectURL(curriculo)\n    }\n\n    const colaborador = new Colaborador(\n      data.nome,\n      data.sobrenome,\n      data.email,\n      data.telefone,\n      data.celular,\n      data.documentoIdentidade,\n      new Date(data.dataNascimento),\n      data.nacionalidade,\n      data.salarioEsperado,\n      data.disponibilidade,\n      data.regioesAtuacao,\n      data.observacoes,\n    )\n\n    // Configurar propriedades adicionais após a criação\n    colaborador.Id = data.id\n    if (fotoPerfil) colaborador.definirFotoPerfil(fotoPerfil)\n    if (curriculo) colaborador.definirCurriculo(curriculo)\n\n    // Reconstrói o endereço se existir\n    if (data.endereco) {\n      const endereco = new Endereco(\n        data.endereco.CEP || data.endereco.cep,\n        data.endereco.Logradouro || data.endereco.logradouro,\n        data.endereco.Numero || data.endereco.numero,\n        data.endereco.Complemento || data.endereco.complemento,\n        data.endereco.Bairro || data.endereco.bairro,\n        data.endereco.Cidade || data.endereco.cidade,\n        data.endereco.Estado || data.endereco.estado,\n      )\n      colaborador.definirEnderecoResidencial(endereco)\n    }\n\n    if (data.experiencias) {\n      data.experiencias.forEach((exp) => {\n        const experiencia = new ExperienciaProfissional(\n          exp.Empresa || exp.empresa,\n          exp.Cargo || exp.cargo,\n          exp.DataInicio\n            ? new Date(exp.DataInicio)\n            : exp.dataInicio\n              ? new Date(exp.dataInicio)\n              : null,\n          exp.DataFim ? new Date(exp.DataFim) : exp.dataFim ? new Date(exp.dataFim) : null,\n          exp.Atividades || exp.atividades || '',\n        )\n        colaborador.adicionarExperienciaProfissional(experiencia)\n      })\n    }\n    if (data.referencias) {\n      data.referencias.forEach((ref) => {\n        const referencia = new Referencia(\n          ref.Nome || ref.nome,\n          ref.Telefone || ref.telefone,\n          ref.Relacao ||\n            ref.relacao ||\n            `${ref.Cargo || ref.cargo} na ${ref.Empresa || ref.empresa}`,\n          ref.Observacoes || ref.observacoes || `Contato: ${ref.Email || ref.email || 'N/A'}`,\n        )\n        colaborador.adicionarReferencia(referencia)\n      })\n    }\n\n    // Define o status se existir\n    if (data.status) {\n      colaborador.atualizarStatus(data.status)\n    }\n    if (data.status) colaborador.Status = data.status\n\n    return colaborador\n  }\n\n  // Converte uma entidade Colaborador em um objeto JSON para armazenamento\n  _mapToJSON(colaborador) {\n    if (!colaborador) return null\n\n    return {\n      id: colaborador.Id,\n      nome: colaborador.Nome,\n      sobrenome: colaborador.Sobrenome,\n      email: colaborador.Email,\n      telefone: colaborador.Telefone,\n      celular: colaborador.Celular,\n      documentoIdentidade: colaborador.DocumentoIdentidade,\n      dataNascimento: colaborador.DataNascimento,\n      nacionalidade: colaborador.Nacionalidade,\n      fotoPerfil: colaborador.FotoPerfil,\n      curriculo: colaborador.Curriculo,\n      salarioEsperado: colaborador.SalarioEsperado,\n      disponibilidade: colaborador.Disponibilidade,\n      regioesAtuacao: colaborador.RegioesAtuacao,\n      observacoes: colaborador.Observacoes,\n      experiencias: colaborador.ExperienciasProfissionais.map((exp) => ({\n        empresa: exp.Empresa,\n        cargo: exp.Cargo,\n        dataInicio: exp.DataInicio,\n        dataFim: exp.DataFim,\n        atividades: exp.Atividades,\n      })),\n      referencias: colaborador.Referencias.map((ref) => ({\n        nome: ref.Nome,\n        telefone: ref.Telefone,\n        relacao: ref.Relacao,\n        observacoes: ref.Observacoes,\n      })),\n      endereco: colaborador.Enderecos?.[0]\n        ? {\n            cep: colaborador.Enderecos[0].CEP,\n            logradouro: colaborador.Enderecos[0].Logradouro,\n            numero: colaborador.Enderecos[0].Numero,\n            complemento: colaborador.Enderecos[0].Complemento,\n            bairro: colaborador.Enderecos[0].Bairro,\n            cidade: colaborador.Enderecos[0].Cidade,\n            estado: colaborador.Enderecos[0].Estado,\n          }\n        : null,\n      status: colaborador.Status,\n    }\n  }\n\n  // Lista todos os colaboradores\n  async getAll() {\n    try {\n      const colaboradores = JSON.parse(localStorage.getItem('colaboradores') || '[]')\n      return colaboradores.map((data) => this._mapToEntity(data))\n    } catch (error) {\n      console.error('Erro ao buscar colaboradores:', error)\n      throw new Error('Erro ao buscar colaboradores')\n    }\n  }\n\n  // Busca um colaborador por ID\n  async getById(id) {\n    try {\n      const colaboradores = JSON.parse(localStorage.getItem('colaboradores') || '[]')\n      const colaborador = colaboradores.find((c) => c.id === id)\n      return this._mapToEntity(colaborador)\n    } catch (error) {\n      console.error('Erro ao buscar colaborador:', error)\n      throw new Error('Erro ao buscar colaborador')\n    }\n  }\n\n  // Salva um novo colaborador\n  async save(colaborador) {\n    try {\n      const colaboradores = JSON.parse(localStorage.getItem('colaboradores') || '[]')\n      const colaboradorJSON = this._mapToJSON(colaborador)\n\n      // Se não tem ID, é um novo colaborador\n      if (!colaboradorJSON.id) {\n        colaboradorJSON.id = crypto.randomUUID()\n        colaboradores.push(colaboradorJSON)\n      } else {\n        // Se tem ID, atualiza o colaborador existente\n        const index = colaboradores.findIndex((c) => c.id === colaboradorJSON.id)\n        if (index >= 0) {\n          colaboradores[index] = colaboradorJSON\n        } else {\n          colaboradores.push(colaboradorJSON)\n        }\n      }\n\n      localStorage.setItem('colaboradores', JSON.stringify(colaboradores))\n      return this._mapToEntity(colaboradorJSON)\n    } catch (error) {\n      console.error('Erro ao salvar colaborador:', error)\n      throw new Error('Erro ao salvar colaborador')\n    }\n  }\n\n  // Exclui um colaborador\n  async delete(id) {\n    try {\n      const colaboradores = JSON.parse(localStorage.getItem('colaboradores') || '[]')\n      const filteredColaboradores = colaboradores.filter((c) => c.id !== id)\n      localStorage.setItem('colaboradores', JSON.stringify(filteredColaboradores))\n    } catch (error) {\n      console.error('Erro ao excluir colaborador:', error)\n      throw new Error('Erro ao excluir colaborador')\n    }\n  }\n}\n\n// Exporta uma única instância do repositório\nexport default new ColaboradorRepository()\n"],"names":[],"mappings":"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"}