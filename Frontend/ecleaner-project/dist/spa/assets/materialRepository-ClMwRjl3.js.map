{"version":3,"file":"materialRepository-ClMwRjl3.js","sources":["../../../src/core/infrastructure/repositories/materialRepository.js"],"sourcesContent":["import { Material } from '../../domain/entities/material'\n\nexport class MaterialRepository {\n  constructor() {\n    // Inicializa o array de materiais no localStorage se não existir\n    if (!localStorage.getItem('materiais')) {\n      localStorage.setItem('materiais', JSON.stringify([]))\n    }\n  }\n\n  // Limpa todos os dados do repositório\n  async clear() {\n    try {\n      localStorage.setItem('materiais', JSON.stringify([]))\n    } catch (error) {\n      console.error('Erro ao limpar materiais:', error)\n      throw new Error('Erro ao limpar materiais')\n    }\n  }\n\n  // Converte um objeto JSON em uma entidade Material\n  _mapToEntity(data) {\n    if (!data) return null\n\n    const material = new Material(\n      data.Descricao,\n      data.Unidade,\n      parseFloat(data.PrecoUnitario) || 0, // Garante que seja um número válido\n      data.Imagem,\n      data.Url,\n    )\n    material.Id = data.Id\n    return material\n  }\n\n  // Converte uma entidade Material em objeto JSON\n  _mapToData(material) {\n    return {\n      Id: material.Id,\n      Descricao: material.Descricao,\n      Unidade: material.Unidade,\n      PrecoUnitario: parseFloat(material.PrecoUnitario) || 0, // Garante que seja um número válido\n      Imagem: material.Imagem,\n      Url: material.Url,\n    }\n  }\n\n  // Busca todos os materiais\n  async getAll() {\n    try {\n      const data = JSON.parse(localStorage.getItem('materiais') || '[]')\n      return data.map((item) => this._mapToEntity(item))\n    } catch (error) {\n      console.error('Erro ao buscar materiais:', error)\n      throw new Error('Erro ao buscar materiais')\n    }\n  }\n\n  // Busca um material por ID\n  async getById(id) {\n    try {\n      const data = JSON.parse(localStorage.getItem('materiais') || '[]')\n      const materialData = data.find((item) => item.Id === id)\n      return this._mapToEntity(materialData)\n    } catch (error) {\n      console.error('Erro ao buscar material:', error)\n      throw new Error('Erro ao buscar material')\n    }\n  }\n\n  // Salva um material (cria novo ou atualiza existente)\n  async save(material) {\n    try {\n      const data = JSON.parse(localStorage.getItem('materiais') || '[]')\n      const existingIndex = data.findIndex((item) => item.Id === material.Id)\n\n      const materialData = this._mapToData(material)\n\n      if (existingIndex >= 0) {\n        // Atualiza material existente\n        data[existingIndex] = materialData\n      } else {\n        // Adiciona novo material\n        data.push(materialData)\n      }\n\n      localStorage.setItem('materiais', JSON.stringify(data))\n      return this._mapToEntity(materialData)\n    } catch (error) {\n      console.error('Erro ao salvar material:', error)\n      throw new Error('Erro ao salvar material')\n    }\n  }\n\n  // Cria um novo material\n  async create(material) {\n    try {\n      const data = JSON.parse(localStorage.getItem('materiais') || '[]')\n      const materialData = this._mapToData(material)\n      data.push(materialData)\n      localStorage.setItem('materiais', JSON.stringify(data))\n      return this._mapToEntity(materialData)\n    } catch (error) {\n      console.error('Erro ao criar material:', error)\n      throw new Error('Erro ao criar material')\n    }\n  }\n\n  // Atualiza um material existente\n  async update(material) {\n    try {\n      const data = JSON.parse(localStorage.getItem('materiais') || '[]')\n      const index = data.findIndex((item) => item.Id === material.Id)\n\n      if (index === -1) {\n        throw new Error('Material não encontrado')\n      }\n\n      const materialData = this._mapToData(material)\n      data[index] = materialData\n      localStorage.setItem('materiais', JSON.stringify(data))\n      return this._mapToEntity(materialData)\n    } catch (error) {\n      console.error('Erro ao atualizar material:', error)\n      throw new Error('Erro ao atualizar material')\n    }\n  }\n\n  // Remove um material\n  async delete(id) {\n    try {\n      const data = JSON.parse(localStorage.getItem('materiais') || '[]')\n      const index = data.findIndex((item) => item.Id === id)\n\n      if (index === -1) {\n        throw new Error('Material não encontrado')\n      }\n\n      data.splice(index, 1)\n      localStorage.setItem('materiais', JSON.stringify(data))\n      return true\n    } catch (error) {\n      console.error('Erro ao deletar material:', error)\n      throw new Error('Erro ao deletar material')\n    }\n  }\n\n  // Busca materiais por descrição (busca parcial)\n  async searchByDescricao(termo) {\n    try {\n      const materiais = await this.getAll()\n      return materiais.filter((material) =>\n        material.Descricao.toLowerCase().includes(termo.toLowerCase()),\n      )\n    } catch (error) {\n      console.error('Erro ao buscar materiais por descrição:', error)\n      throw new Error('Erro ao buscar materiais por descrição')\n    }\n  }\n}\n"],"names":[],"mappings":"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"}